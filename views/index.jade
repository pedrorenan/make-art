doctype html
html(lang='en',  xmlns:ng="http://angularjs.org")
    head
        //- Generic
        meta(charset='UTF-8')
        link(rel="shortcut icon", href="/favicon.ico", type="image/x-icon")

        //- SEO
        meta(name="google-site-verification" content="OCQroE3v9jKgCFFNBnVeejsgn4Qb5IvNbr_oUyoU-Tw")

        //- Mobile options
        meta(name='apple-mobile-web-app-capable', content='yes')
        meta(name='apple-mobile-web-app-status-bar-style', content='orange')
        meta(name='viewport', content='initial-scale=1, maximum-scale=1, user-scalable=no')


        //- Styles
        link(href='/css/main.css', rel='stylesheet', type='text/css')

        script(type="text/javascript").
            window.dataLayer = [];
            window.dataLayer.push({
                originalLocation: document.location.protocol + '//' +
                                  document.location.hostname +
                                  document.location.pathname +
                                  document.location.search
            });
            (function() {
                window.XMLHttpRequest = window.XMLHttpRequest || (function() {
                    return new window.ActiveXObject("Microsoft.XMLHTTP");
                });
            })();
        title Draw

    body(id="ng-app", class=offline ? 'offline' : 'online')

        script(src='/js/vendor/console-polyfill.js', type='text/javascript')
        .loading-overlay(ng-cloak): .spinner

        ng-view

        //- Vendor
        script(src='/js/vendor/require.js', type='text/javascript')
        script(type='text/javascript').
            window.appRequire = require.config({ context: 'app' })
        script(src='/js/vendor/angular.min.js', type='text/javascript')
        script(src='/js/vendor/angular-route.min.js', type='text/javascript')
        script(src='/js/vendor/ace/ace.js', type='text/javascript')
        script(src='/js/vendor/ace/ext-language_tools.js', type='text/javascript')

        script(type='text/javascript').
            window.ENV = '#{env}';

            window.CONFIG = {
                PRODUCTION      : #{production},
                OFFLINE         : #{offline},
                SEGMENTIO_ID    : '#{segmentioId}',
                FACEBOOK_APP_ID : '#{facebookAppId}',
                API_URL         : '#{api_url}',
                API_URL_V2      : '#{api_url_v2}',
                WORLD_URL       : '#{world_url}',
                CHALLENGES_URL  : '#{challenges_url}',
                TEST_MODE       : #{testmode},
                ENV             : '#{env}',
                UNKNOWN_USER    : '#{unknown_user}'
            };

        //- App
        script(type='text/javascript').
            window.appRequire(['/js/index.js'], function() { angular.bootstrap(document, ['draw']); }, function(e) { console.error(e) })

        //- Livereload
        if !production && !staging
            script(src='http://localhost:35729/livereload.js?snipver=1', type='text/javascript')

        //- Google Tag Manager
        noscript
          iframe(src='//www.googletagmanager.com/ns.html?id=GTM-WMGKFR', height='0', width='0', style='display: none; visibility: hidden;')
        script(type='text/javascript').
          (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
          new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
          j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
          '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
          })(window,document,'script','dataLayer','GTM-WMGKFR');
        //- End Google Tag Manager
